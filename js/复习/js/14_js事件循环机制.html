
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>js事件循环机制</title>
</head>
<body>
    <script>
        // js事件循环机制
        // js基于单线程运行，有同步和异步区分
        // 同步任务在js引擎线程上执行，形成一个执行栈
        // 事件触发线程管理一个任务队列，异步任务触发条件达成时，则将其回调放到任务队列中
        // 一旦执行栈中所有同步任务执行完毕后，读取任务队列，将可执行的异步任务添加到执行栈中，开始执行

        // 宏任务：可以将每次执行栈执行的代码当作是一个宏任务（包括从任务队列中取出来的事件），宏任务执行完后，在下一个宏任务执行前，GUI渲染线程开始工作渲染页面
        // eg: setTimeout, setInterval

        // 微任务：可以理解为在当前宏任务执行后立即执行的任务，也就是会在渲染前，将执行宏任务期间所产生的所有微任务都执行完
        // eg: promise, process.nextTick

        // 总结
        // 1.执行一个宏任务（栈中没有就从任务队列中获取）
        // 2.执行过程中如果遇到微任务，就将它添加到微任务的任务队列中
        // 3.宏任务执行完毕后，立即执行微任务队列中的所有微任务（依次执行）
        // 4.当前宏任务与微任务都执行完后，开始检查渲染，进行GUI线程接管渲染
        // 5.渲染完毕后，js线程接管，开始下一个宏任务
    </script>
</body>
</html>